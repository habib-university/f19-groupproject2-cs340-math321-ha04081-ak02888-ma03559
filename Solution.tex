\documentclass[a4paper, 11pt]{article}

\usepackage{parskip}
\usepackage{hyperref}
\hypersetup{ colorlinks, citecolor=green, filecolor=black, linkcolor=blue, urlcolor=blue } 

\usepackage{colortbl}

\usepackage{amsfonts}

\usepackage[left=2cm, right=2cm, top=2cm]{geometry}
\usepackage{float}
\usepackage{afterpage}
\usepackage{multirow}

\usepackage{gensymb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{textcomp}
\usepackage{enumitem}

\newcommand{\points}[1]{(\textbf{#1 marks}) }
\newcommand{\vecthree}[3]{\begin{pmatrix} #1 \\ #2 \\ #3 \end{pmatrix}}
\newcommand{\vecfour}[4]{\begin{pmatrix} #1 \\ #2 \\ #3 \\ #4\end{pmatrix}}
\newcommand{\mat}[1]{\boldsymbol { \mathsf{#1}} }

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\newcommand{\norm}[1]{\lVert#1\rVert}
\newcommand{\R}{\mathbb{R}}

\definecolor{mycolor}{rgb}{0,0.6,0.5}

\title{CS340/MATH321 -- Geometrical modelling and numerical analysis \\ Group project 2}
\vspace{-10em}
\date{Fall 2019}
\author{Huda Feroz Ahmed \and Aiman Khan \and Muhammad Shahrom Ali}

\begin{document}
\maketitle  
\setlength{\parskip}{10pt}
\setlength{\parindent}{0pt}
\DeclareGraphicsExtensions{.pdf,.png,.gif,.jpg}


\section*{Answers}
\begin{enumerate}
    
\item \textbf{(50 points)} The following question asks you to explore and implement the equation \[\vec p(s, t) = \sum N_i(s, t) \vec p_i\] in two- and three-dimensions

\begin{enumerate}[label=\alph*.]
    \item \textbf{(3 points)} Draw all the linear and quadratic B\'{e}zier basis functions over a unit interval and a unit square \\
    Solution: \\
    Figure \ref{fig:bezierBasisCurve} represents the linear and quadratic B\'{e}zier basis functions over a unit interval: 
    \begin{figure}[h] 
  \subfigure[Linear Bezier basis]{% 
    \includegraphics[scale=0.5]{resources/bezierBasisFunctionCurve1.png} \label{fig:bezierBasisCurve1} 
  } 
 \quad 
  \subfigure[Quadratic Bezier basis]{% 
    \includegraphics[scale=0.5]{resources/bezierBasisFunctionCurve2.png} \label{fig:bezierBasisCurve2} 
  } 
  \caption{Bezier Basis over Unit Interval} 
  \centering
  \label{fig:bezierBasisCurve}
\end{figure} \\
Figure \ref{fig:bezierBasisSurface} represents the linear and quadratic B\'{e}zier basis functions over a unit square: 
\begin{figure}[ht] 
  \subfigure[Linear Bezier basis]{% 
    \includegraphics[scale=0.25]{resources/bezierBasisFunctionSurface1.png} \label{fig:bezierBasisSurface1} 
  } 
 \quad 
  \subfigure[Quadratic Bezier basis]{% 
    \includegraphics[scale=0.25]{resources/bezierBasisFunctionSurface2.png} \label{fig:bezierBasisSurface2} 
  } 
  \caption{Bezier Basis over Unit Square} 
  \label{fig:bezierBasisSurface}
\end{figure}
    \item \textbf{(3 points)} Draw a linear, quadratic, cubic, quartic b-splines basis functions in 1D over a uniform knot vector \\
    Solution: \\
    Figure \ref{fig:bsplineBasis} represents the b-spline basis functions for uniform knot vector \([1,2,3,4,5,6]\).
    \begin{figure}[ht] 
  \subfigure[Linear b-spline basis]{% 
    \includegraphics[scale=0.5]{resources/bSplineBasisk2.png} \label{fig:linearBSpline}
  } 
 \quad 
  \subfigure[Quadratic b-spline basis]{% 
    \includegraphics[scale=0.5]{resources/bSplineBasisk3.png} \label{fig:quadraticBSpline} 
  } \\
  \quad 
  \subfigure[Cubic b-spline basis]{% 
    \includegraphics[scale=0.5]{resources/bSplineBasisk4.png} \label{fig:cubicBSpline} 
  }
  \quad 
  \subfigure[Quartic b-spline basis]{% 
    \includegraphics[scale=0.5]{resources/bSplineBasisk5.png} \label{fig:quarticBSpline} 
  }
  \caption{B-Spline Basis for knot vector \([1,2,3,4,5,6]\)} 
  \label{fig:bsplineBasis}
\end{figure}
    
    \item \textbf{(3 points)} Draw quadratic, cubic, and quartic B\'{e}zier curves by arbitrary defining the appropriate control points \\
    Figure \ref{fig:bezierCurves} represents the different bezier curves formed.
        \begin{figure}[ht] 
  \subfigure[Quadratic Bezier Curve]{% 
    \includegraphics[scale=0.5]{resources/QuadraticBezierCurve.png} \label{fig:quadraticBezierCurve} 
  } 
 \quad 
  \subfigure[Cubic Bezier Curve]{% 
    \includegraphics[scale=0.5]{resources/CubicBezierCurve.png} \label{fig:cubicBezierCurve} 
  } \\
  \quad 
  \subfigure[Quartic Bezier Curve]{% 
    \includegraphics[scale=0.5]{resources/QuarticBezierCurve.png} \label{fig:quaricBezierCurve} 
  }
  \caption{Bezier Curves of different degrees} 
  \label{fig:bezierCurves}
\end{figure}
    \item \textbf{(6 points)} The curve generated using B\'{e}zier basis functions do not usually pass through the control points. Derive new quadratic and cubic polynomial basis functions $N_i(t)$ which when linearly combined with the control points $\vec p_i$ will generate a curve which passes through the control points. Draw them and comment on potential advantages and disadvantages of these basis functions. You can define the control points arbitrarily. 
    \item \textbf{(6 points)} Now imagine you have a cubic B\'{e}zier curves $\vec P(t)$ and $\vec Q(t)$, derive the conditions on the control points such that the curves $\vec P(t)$ join the curve $\vec Q(t)$ with $C^1$ and with $C^2$ continuity. What is the continuity of the cubic B\'{e}zier curve $\vec P(t)$ by itself.
    \\Solution: \\
    The equations for cubic bezier curves \(P(t)\) and \(Q(t)\) can be written as:
    \begin{equation}
    \label{eq:p(t)}
        P(t) = (t-1)^3 P_0 + 3(t-1)^2 t P_1 + 3(t-1) t^2 P_2 + t^3 P_3 
    \end{equation}
    \begin{equation}
    \label{eq:q(t)}
        Q(t) = (t-1)^3 Q_0 + 3(t-1)^2 t Q_1 + 3(t-1) t^2 Q_2 + t^3 Q_3 
    \end{equation}
    To ensure, \(C^0\) continuity, equation \ref{eq:c0} should satisfy
    \begin{equation}
        \label{eq:c0}
        P(1) = Q(0)
    \end{equation}
    Following from equation \ref{eq:c0} we have:
    \begin{equation}
        \label{eq:c0-1}
        P_3 = Q_0
    \end{equation}
    To ensure, \(C^1\) continuity, equation \ref{eq:c1} should satisfy
    \begin{equation}
        \label{eq:c1}
        P'(1) = Q'(0)
    \end{equation}
    Following from equation \ref{eq:c1} we have:
    \begin{equation}
        \label{eq:c1-1}
        -3P_2 + 3P_3 = -3Q_0 + 3Q_1
    \end{equation} 
    By simplifying equation \ref{eq:c1-1} and substituting the value of \(Q_0\) from equation \ref{eq:c0-1} we get the conditions on the control points such that the curve \(\vec P(t) \) joins the curve \(\vec Q(t)\) with \(C^1\) continuity:
    \begin{equation}
        \label{eq:c1-2}
        \boxed{2P_3 - P_2 = Q_1}
    \end{equation}
    To ensure, \(C^2\) continuity, equation \ref{eq:c2} should satisfy
    \begin{equation}
        \label{eq:c2}
        P''(1) = Q''(0)
    \end{equation}
    Following from equation \ref{eq:c2} we have:
    \begin{equation}
        \label{eq:c2-1}
       6P_1 - 12P_2 + 6P_3 = 6Q_0 - 12Q_1 + 6Q_2
    \end{equation} 
    By simplifying equation \ref{eq:c2-1} and substituting the value of \(Q_0\) from equation \ref{eq:c0-1} we get the conditions on the control points such that the curve \(\vec P(t) \) joins the curve \(\vec Q(t)\) with \(C^2\) continuity:
    \begin{equation}
        \label{eq:c2-2}
        P_1 - 2P_2 = -2Q_1 + Q_2
    \end{equation}
    Using the constraints for \(C^1\) continuity, we can substitute the value of \(Q_1\) from equation \ref{eq:c1-2}, to obtain the simplified condition for \(C^2\) continuity:
    \begin{equation}
        \label{eq:c2-2}
        \boxed{P_1 - 4P_2 + 4P_3 = Q_2}
    \end{equation}
    \item \textbf{(9 points)} For part e), draw a figure which demonstrates that the curve $\vec P(t)$ joins the curve $\vec Q(t)$ with $C^1$ continuity. Draw a similar figure(s) which demonstrates that the curves join with $C^2$ continuity. The figure must be generated by some algorithm/function. \\
    Solution: \\
    Figure \ref{fig:bezierCurvesJoined} represents the curves \(P(t)\) and \(Q(t)\) joined by different continuities. 
    \begin{figure}[ht] 
  \subfigure[Curves joined by \(C^{-1}\) continuity]{% 
    \includegraphics[scale=0.5]{resources/BezierC-1.png} \label{fig:c-1} 
  } 
 \quad 
  \subfigure[Curves joined by \(C^{0}\) continuity]{% 
    \includegraphics[scale=0.5]{resources/BezierC0.png} \label{fig:c0} 
  } \\
  \quad 
  \subfigure[Curves joined by \(C^{1}\) continuity]{% 
    \includegraphics[scale=0.5]{resources/BezierC1.png} \label{fig:c1} 
  }
  \quad 
  \subfigure[Curves joined by \(C^{2}\) continuity]{% 
    \includegraphics[scale=0.5]{resources/BezierC2.png} \label{fig:c2} 
  }
  \caption{Cubic Bezier Curves \(P(t)\) and \(Q(t)\) joined by different continuities.} 
  \label{fig:bezierCurvesJoined}
\end{figure}
    \item \textbf{(9 points)} Repeat parts c-d for a single patch with tensor product structure
    \item \textbf{(2 points)} Consider two arbitrary tensor product quadratic B\'{e}zier patches $\vec P(s,t)$ and $\vec Q(s,t)$, describe (qualitatively or mathematically) the conditions for $C^1$ continuity along the edge at which they meet?  
    \item \textbf{(9 points)} Define arbitrary control points for patches $\vec P(s,t)$ and $\vec Q(s,t)$ and generate a figure which demonstrates whether the patches connects with $C^1$ continuity. The figure must be generated by some algorithm/function.
\end{enumerate}

\item \textbf{(10 points)} This question asks you to generate a curve defined by the control points using the quadratic B\'{e}zier basis functions. You are given a circle.txt file. It has 16 vertices and 8 faces (line elements). Figure \ref{fig:lineMesh} shows this mesh. Describe succinctly what you have done

\begin{figure}
\includegraphics[scale=0.25]{resources/circleMesh.png} 
\centering
\caption{Line mesh of the circle}
\label{fig:lineMesh}
\end{figure}

Each face (element) of the mesh comprises of three vertices. For example circle.txt file shows that the second face comprises of vertices \{2, 3, 4\}. Using the parametrisation show in figure \ref{fig:lineElement}, generate the resulting geometry using the quadratic B\'{e}zier basis functions.
\begin{figure}
\includegraphics[scale=0.5]{resources/quadraticLineElement.pdf} 
\centering
\caption{Parametrisation of quadratic line element}
\label{fig:lineElement}
\end{figure}

\item \textbf{(20 points)} You are now asked to generalise your algorithm in question 2 from curves to surfaces. Given the mesh for the one-eighth of a sphere in sphere.txt. The screenshot of the mesh is shown in Figure \ref{fig:sphereFig}

\begin{figure}
\includegraphics[scale=0.35]{resources/sphere.png} 
\centering
\caption{Mesh for the one-eighth of a sphere}
\label{fig:sphereFig}
\end{figure}

The 'sphere.txt' file has 224 vertices and 60 quadrilateral faces/elements. Each quadrilateral face/element comprises of 9 points. The quadrilateral in the sphere.txt numbers the vertices as shown in figure \ref{fig:sphereNodeNumber}. Generate the surface represented by the mesh  using the quadratic B\'{e}zier basis functions
\begin{figure}
\includegraphics[scale=0.35]{resources/quadraticSquareElement.pdf} 
\centering
\caption{Mesh for the one-eighth of a sphere}
\label{fig:sphereNodeNumber} 
\end{figure}

\newpage

\section{Appendix A}
  
  \begin{verbatim}
      Write Code here if you wanna.
  \end{verbatim}

\newpage

\begin{thebibliography}{9}
  \bibitem {testBIBI} Test Item. Remove this please 
  \begin{verbatim}
      testing Capabilities. Remove this when adding the first Reference Item
  \end{verbatim}

\end{thebibliography}


\end{enumerate}
\end{document}